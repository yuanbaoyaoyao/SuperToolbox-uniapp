"use strict";const t=require("../../common/vendor.js"),s={props:{color:{type:Object,default:()=>({r:0,g:0,b:0,a:0})},spareColor:{type:Array,default:()=>[]}},data:()=>({show:!1,active:!1,rgba:{r:0,g:0,b:0,a:1},hsb:{h:0,s:0,b:0},site:[{top:0,left:0},{left:0},{left:0}],index:0,bgcolor:{r:255,g:0,b:0,a:1},hex:"#000000",mode:!0,colorList:[{r:244,g:67,b:54,a:1},{r:233,g:30,b:99,a:1},{r:156,g:39,b:176,a:1},{r:103,g:58,b:183,a:1},{r:63,g:81,b:181,a:1},{r:33,g:150,b:243,a:1},{r:3,g:169,b:244,a:1},{r:0,g:188,b:212,a:1},{r:0,g:150,b:136,a:1},{r:76,g:175,b:80,a:1},{r:139,g:195,b:74,a:1},{r:205,g:220,b:57,a:1},{r:255,g:235,b:59,a:1},{r:255,g:193,b:7,a:1},{r:255,g:152,b:0,a:1},{r:255,g:87,b:34,a:1},{r:121,g:85,b:72,a:1},{r:158,g:158,b:158,a:1},{r:0,g:0,b:0,a:.5},{r:0,g:0,b:0,a:0}]}),created(){this.rgba=this.color,0!==this.spareColor.length&&(this.colorList=this.spareColor)},methods:{init(){this.hsb=this.rgbToHex(this.rgba),this.setValue(this.rgba)},moveHandle(){},open(){this.show=!0,this.$nextTick((()=>{this.init(),setTimeout((()=>{this.active=!0,setTimeout((()=>{this.getSelectorQuery()}),350)}),50)}))},close(){this.active=!1,this.$nextTick((()=>{setTimeout((()=>{this.show=!1}),500)}))},confirm(){this.close(),this.$emit("confirm",{rgba:this.rgba,hex:this.hex})},select(){this.mode=!this.mode},selectColor(t){this.setColorBySelect(t)},touchstart(t,s){const{pageX:e,pageY:o}=t.touches[0];this.pageX=e,this.pageY=o,this.setPosition(e,o,s)},touchmove(t,s){const{pageX:e,pageY:o}=t.touches[0];this.moveX=e,this.moveY=o,this.setPosition(e,o,s)},touchend(t,s){},setPosition(t,s,e){this.index=e;const{top:o,left:h,width:i,height:r}=this.position[e];this.site[e].left=Math.max(0,Math.min(parseInt(t-h),i)),0===e?(this.site[e].top=Math.max(0,Math.min(parseInt(s-o),r)),this.hsb.s=parseInt(100*this.site[e].left/i),this.hsb.b=parseInt(100-100*this.site[e].top/r),this.setColor(),this.setValue(this.rgba)):this.setControl(e,this.site[e].left)},setColor(){const t=this.HSBToRGB(this.hsb);this.rgba.r=t.r,this.rgba.g=t.g,this.rgba.b=t.b},setValue(t){this.hex="#"+this.rgbToHex(t)},setControl(t,s){const{top:e,left:o,width:h,height:i}=this.position[t];1===t?(this.hsb.h=parseInt(360*s/h),this.bgcolor=this.HSBToRGB({h:this.hsb.h,s:100,b:100}),this.setColor()):this.rgba.a=(s/h).toFixed(1),this.setValue(this.rgba)},rgbToHex(t){let s=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];return s.map((function(t,e){1==t.length&&(s[e]="0"+t)})),s.join("")},setColorBySelect(t){const{r:s,g:e,b:o,a:h}=t;let i={};i={r:s?parseInt(s):0,g:e?parseInt(e):0,b:o?parseInt(o):0,a:h||0},this.rgba=i,this.hsb=this.rgbToHsb(i),this.changeViewByHsb()},changeViewByHsb(){const[t,s,e]=this.position;this.site[0].left=parseInt(this.hsb.s*t.width/100),this.site[0].top=parseInt((100-this.hsb.b)*t.height/100),this.setColor(this.hsb.h),this.setValue(this.rgba),this.bgcolor=this.HSBToRGB({h:this.hsb.h,s:100,b:100}),this.site[1].left=this.hsb.h/360*s.width,this.site[2].left=this.rgba.a*e.width},HSBToRGB(t){let s={},e=Math.round(t.h),o=Math.round(255*t.s/100),h=Math.round(255*t.b/100);if(0==o)s.r=s.g=s.b=h;else{let t=h,i=(255-o)*h/255,r=e%60*(t-i)/60;360==e&&(e=0),e<60?(s.r=t,s.b=i,s.g=i+r):e<120?(s.g=t,s.b=i,s.r=t-r):e<180?(s.g=t,s.r=i,s.b=i+r):e<240?(s.b=t,s.r=i,s.g=t-r):e<300?(s.b=t,s.g=i,s.r=i+r):e<360?(s.r=t,s.g=i,s.b=t-r):(s.r=0,s.g=0,s.b=0)}return{r:Math.round(s.r),g:Math.round(s.g),b:Math.round(s.b)}},rgbToHsb(t){let s={h:0,s:0,b:0},e=Math.min(t.r,t.g,t.b),o=Math.max(t.r,t.g,t.b),h=o-e;return s.b=o,s.s=0!=o?255*h/o:0,0!=s.s?t.r==o?s.h=(t.g-t.b)/h:t.g==o?s.h=2+(t.b-t.r)/h:s.h=4+(t.r-t.g)/h:s.h=-1,s.h*=60,s.h<0&&(s.h=0),s.s*=100/255,s.b*=100/255,s},getSelectorQuery(){t.index.createSelectorQuery().in(this).selectAll(".boxs").boundingClientRect((t=>{t&&0!==t.length?(this.position=t,this.setColorBySelect(this.rgba)):setTimeout((()=>this.getSelectorQuery()),20)})).exec()}},watch:{spareColor(t){this.colorList=t}}};const e=t._export_sfc(s,[["render",function(s,e,o,h,i,r){return{a:i.active?1:"",b:t.o(((...t)=>r.close&&r.close(...t))),c:t.o(((...t)=>r.close&&r.close(...t))),d:t.o(((...t)=>r.confirm&&r.confirm(...t))),e:i.site[0].top-8+"px",f:i.site[0].left-8+"px",g:t.o((t=>r.touchstart(t,0))),h:t.o((t=>r.touchmove(t,0))),i:t.o((t=>r.touchend(t,0))),j:"rgb("+i.bgcolor.r+","+i.bgcolor.g+","+i.bgcolor.b+")",k:"rgba("+i.rgba.r+","+i.rgba.g+","+i.rgba.b+","+i.rgba.a+")",l:i.site[1].left-12+"px",m:t.o((t=>r.touchstart(t,1))),n:t.o((t=>r.touchmove(t,1))),o:t.o((t=>r.touchend(t,1))),p:i.site[2].left-12+"px",q:t.o((t=>r.touchstart(t,2))),r:t.o((t=>r.touchmove(t,2))),s:t.o((t=>r.touchend(t,2))),t:t.f(i.colorList,((s,e,o)=>({a:"rgba("+s.r+","+s.g+","+s.b+","+s.a+")",b:t.o((t=>r.selectColor(s)),e),c:e}))),v:i.active?1:"",w:i.show,x:t.o(((...t)=>r.moveHandle&&r.moveHandle(...t)))}}]]);wx.createComponent(e);

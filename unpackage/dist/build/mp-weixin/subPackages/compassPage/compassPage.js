"use strict";const e=require("../../common/vendor.js"),t=require("../../store/index.js"),s={onShareAppMessage(){},onShareTimeline(){},data:()=>({screenHeight:0,screenWidth:0,centerX:0,centerY:0,degree:0,myCanvas1:null,myCanvas2:null,compassValue:0,direction:"北",isWorking:!1}),onReady(){"android"!=t.store.getters.platform&&"ios"!=t.store.getters.platform&&e.index.showModal({title:"提示",content:"此功能需要在手机端才能正常使用。",showCancel:!1,success:function(e){e.confirm?console.log("用户点击确定"):e.cancel&&console.log("用户点击取消")}}),this.handleGetSysInfo();let s=this;e.index.onCompassChange((e=>{s.compassValue=parseInt(e.direction),s.compassValue>345&&s.compassValue<15?s.direction="北":s.compassValue>=15&&s.compassValue<=75?s.direction="东北":s.compassValue>75&&s.compassValue<105?s.direction="东":s.compassValue>=105&&s.compassValue<=165?s.direction="东南":s.compassValue>165&&s.compassValue<195?s.direction="南":s.compassValue>=195&&s.compassValue<=255?s.direction="西南":s.compassValue>255&&s.compassValue<285?s.direction="西":s.compassValue>=285&&s.compassValue<=345&&(s.direction="西北"),s.drawPointer(e.direction),this.isWorking=!0}))},methods:{countDigits(e){if(0===e)return 1;let t=0;for(;e>0;)t++,e=Math.floor(e/10);return t},handleGetSysInfo(){let t=this;e.index.getSystemInfo({success:function(s){t.myCanvas2=e.index.createCanvasContext("myCanvas2"),t.myCanvas1=e.index.createCanvasContext("myCanvas"),t.screenHeight=s.screenHeight,t.screenWidth=s.screenWidth,t.drawRoundImage()}})},drawPointer(e){let t,s=this.myCanvas2;s.clearRect(0,0,this.screenHeight,this.screenWidth);let a=this.screenHeight;a/2>this.screenWidth&&(a=2*this.screenWidth);const n=this.screenWidth/2,i=a/2,o=.9*n,r=n-o/2,c=i-o/2;null!=e&&(t=e*Math.PI/180,s.save(),s.translate(n,i),s.rotate(t),s.translate(-n,-i)),s.beginPath(),s.moveTo(r+.43*o,i),s.lineTo(n,c),s.lineTo(r+.57*o,i),s.lineTo(r+.43*o,i),s.fillStyle="#ff0000",s.fill(),s.closePath(),s.beginPath(),s.moveTo(r+.43*o,i),s.lineTo(n,c+o),s.lineTo(r+.57*o,i),s.lineTo(r+.43*o,i),s.fillStyle="#333333",s.fill(),s.closePath(),s.draw()},drawRoundImage(e){let t,s,a;null!=e&&(t=e.touches[0].pageX,s=e.touches[0].pageY);let n=this.screenHeight,i=this.myCanvas1;n/2>this.screenWidth&&(n=2*this.screenWidth);const o=this.screenWidth/2,r=n/2,c=this.screenWidth/2-50,l=this.screenWidth/2-30,h=this.screenWidth/2-80;null!=e&&(a=Math.atan2(s-r,t-o),i.save(),i.translate(o,r),i.rotate(a),i.translate(-o,-r));for(let d=0;d<=360;d+=2){let e=10;d%30!=0&&0!=d||(e=15);const t=d*Math.PI/180-Math.PI/2,s=o+Math.cos(t)*(c+e),a=r+Math.sin(t)*(c+e),n=o+Math.cos(t)*c,u=r+Math.sin(t)*c;if((d%30==0||0==d)&&360!=d){const e=d*Math.PI/180-Math.PI/2,t=o+Math.cos(e)*l,s=r+Math.sin(e)*l;let a;i.setFontSize(12),1==this.countDigits(d)?a=-1.2*Math.PI/180:2==this.countDigits(d)?a=-2.5*Math.PI/180:3==this.countDigits(d)&&(a=-3.7*Math.PI/180),i.save(),i.translate(o,r),i.rotate(a),i.translate(-o,-r),i.translate(t,s),i.rotate(d*Math.PI/180),i.fillText(d,0,0),i.restore()}if((d%45==0||0==d)&&360!=d){const e=d*Math.PI/180-Math.PI/2,t=o+Math.cos(e)*h,s=r+Math.sin(e)*h;i.setFontSize(20);let a=-5*Math.PI/180;switch(i.save(),i.translate(o,r),i.rotate(a),i.translate(-o,-r),i.translate(t,s),i.rotate(d*Math.PI/180+.08),d){case 0:i.fillText("北",0,0);break;case 90:i.fillText("东",0,0);break;case 180:i.fillText("南",0,0);break;case 270:i.fillText("西",0,0)}i.restore()}i.beginPath(),i.moveTo(s,a),i.lineTo(n,u),i.setStrokeStyle("#333333"),i.stroke(),i.closePath()}i.restore(),i.draw()}}};const a=e._export_sfc(s,[["render",function(t,s,a,n,i,o){return e.e({a:i.isWorking},i.isWorking?{b:e.t(i.direction),c:e.t(i.compassValue)}:{})}]]);s.__runtimeHooks=6,wx.createPage(a);

"use strict";const e=require("../../common/vendor.js");require("../../common/utils/xlsx.full.min.js");var t=require("../../common/utils/xlsx.full.min.js");const s={data:()=>({names:[],nameText:"",isStarting:!1,timer:null,isAllowsDuplicates:!1,excelData:[],textValue:"",isShowDialog:!1,isReturn:!0}),methods:{handleClearInfo(){this.names=[],this.isShowDialog=!1,e.index.showToast({icon:"none",title:"清空信息成功"})},handleHideDialog(){this.isShowDialog=!1},openDialog(){this.names.length>0&&(this.isShowDialog=!0)},handelDeleteItem(e){this.names.splice(e,1)},addStringToArray(e,t){var s=e.split(/[,，]/);return t=t.concat(s)},handleChangeTextValue(e){this.textValue=e},handleImportText(){this.names=this.addStringToArray(this.textValue,this.names)},chooseFile(t){let s=this;e.wx$1.chooseMessageFile({count:1,type:"file",extension:[".xls",".xlsx"],success:t=>{try{const i=t.tempFiles[0].path,n=e.wx$1.getFileSystemManager().readFileSync(i,"binary");s.process(n)}catch(i){return console.error(i),void e.index.showModal({title:"提示",content:"文件读取失败",showCancel:!1})}}})},process(e){let s=t.read(e,{type:"binary"});const i=s.SheetNames[0];let n=s.Sheets[i];const a=t.utils.sheet_to_json(n,{raw:!1});for(let t of a){const e=Object.values(t);for(let t of e)this.names.push(t)}},start(){this.names.length>0?(this.isStarting=!0,this.isReturn=!1,this.timer=setInterval((()=>{let e=Math.floor(Math.random()*this.names.length);this.nameText=this.names[e]}),50)):e.index.showToast({icon:"none",title:"请先输入信息"})},stop(){this.isStarting=!1,clearInterval(this.timer),this.timer=null},handleReturn(){this.isReturn=!0}}};if(!Array){e.resolveComponent("defaultInput")()}Math;const i=e._export_sfc(s,[["render",function(t,s,i,n,a,o){return e.e({a:a.names.length>0},a.names.length>0?e.e({b:a.isStarting||!a.isReturn},a.isStarting||!a.isReturn?{c:e.t(a.nameText)}:{d:e.f(a.names,((t,s,i)=>({a:e.t(t),b:s,c:e.o((e=>o.handelDeleteItem(s)),s)})))}):{},{e:e.o(((...e)=>o.openDialog&&o.openDialog(...e))),f:e.o(o.handleChangeTextValue),g:e.p({placeholder:"请输入文本,根据逗号分割"}),h:e.o(((...e)=>o.chooseFile&&o.chooseFile(...e))),i:e.o(((...e)=>o.handleImportText&&o.handleImportText(...e))),j:!a.isReturn&&!a.isStarting},a.isReturn||a.isStarting?{}:{k:e.o(((...e)=>o.handleReturn&&o.handleReturn(...e)))},{l:!a.isStarting},a.isStarting?{o:e.o(((...e)=>o.stop&&o.stop(...e)))}:{m:e.t(a.isReturn?"开始":"继续"),n:e.o(((...e)=>o.start&&o.start(...e)))},{p:a.isShowDialog},(a.isShowDialog,{}),{q:a.isShowDialog},a.isShowDialog?{r:e.o(((...e)=>o.handleHideDialog&&o.handleHideDialog(...e))),s:e.o(((...e)=>o.handleClearInfo&&o.handleClearInfo(...e)))}:{})}]]);wx.createPage(i);
